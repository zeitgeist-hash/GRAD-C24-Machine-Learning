<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Time Series Forecasting on Energy Consumption</title>

  <meta property="description" itemprop="description" content="In this article we provide some exciting results of our exploration of different supervised Machine Learning algorithms (ARIMA, Extra Trees, Gradient Boosting and Support Vector Machines) and an Auto Machine Learning Framework (AutoGluon) in predicting power consumption for the city of Tetouan, Morocco in 2017. The data set is a time series that alsoincludes different markers of the weather conditions during that time, such as temperature, wind speed, and humidity. We build on work from an existing study, with a different approach in terms of data cleaning/transformation and models selected. We use a variety of models in an attempt to find which one best optimizes both accuracy and computational efficiency."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-05-10"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-05-10"/>
  <meta name="article:author" content="Kabir Sandrolini"/>
  <meta name="article:author" content="Katalin Bayer"/>
  <meta name="article:author" content="Jiayu Yang"/>
  <meta name="article:author" content="Angela Duarte Pardo"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Time Series Forecasting on Energy Consumption"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="In this article we provide some exciting results of our exploration of different supervised Machine Learning algorithms (ARIMA, Extra Trees, Gradient Boosting and Support Vector Machines) and an Auto Machine Learning Framework (AutoGluon) in predicting power consumption for the city of Tetouan, Morocco in 2017. The data set is a time series that alsoincludes different markers of the weather conditions during that time, such as temperature, wind speed, and humidity. We build on work from an existing study, with a different approach in terms of data cleaning/transformation and models selected. We use a variety of models in an attempt to find which one best optimizes both accuracy and computational efficiency."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Time Series Forecasting on Energy Consumption"/>
  <meta property="twitter:description" content="In this article we provide some exciting results of our exploration of different supervised Machine Learning algorithms (ARIMA, Extra Trees, Gradient Boosting and Support Vector Machines) and an Auto Machine Learning Framework (AutoGluon) in predicting power consumption for the city of Tetouan, Morocco in 2017. The data set is a time series that alsoincludes different markers of the weather conditions during that time, such as temperature, wind speed, and humidity. We build on work from an existing study, with a different approach in terms of data cleaning/transformation and models selected. We use a variety of models in an attempt to find which one best optimizes both accuracy and computational efficiency."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Comparison of machine learning algorithms for the power consumption prediction:-case study of tetouan city–;citation_publication_date=2018;citation_publisher=IEEE;citation_author=Abdulwahed Salam;citation_author=Abdelaaziz El Hibaoui"/>
  <meta name="citation_reference" content="citation_title=AutoGluon-tabular: Robust and accurate AutoML for structured data;citation_publication_date=2020;citation_author=Nick Erickson;citation_author=Jonas Mueller;citation_author=Alexander Shirkov;citation_author=Hang Zhang;citation_author=Pedro Larroy;citation_author=Mu Li;citation_author=Alexander Smola"/>
  <meta name="citation_reference" content="citation_title=Analysis on approaches and structures of automated machine learning frameworks;citation_publication_date=2020;citation_publisher=IEEE;citation_author=Peixuan Ge"/>
  <meta name="citation_reference" content="citation_title=E-handbook of statistical methods,;citation_publication_date=2012;citation_publisher=http://www.itl.nist.gov/div898/handbook/;citation_author= NIST/SEMATECH"/>
  <meta name="citation_reference" content="citation_title=R2 measures for time series;citation_publication_date=1979;citation_publisher=[American Statistical Association, Taylor &amp; Francis, Ltd.];citation_volume=74;citation_issn=01621459;citation_author=David A. Pierce"/>
  <meta name="citation_reference" content="citation_title=Augmented dickey fuller test (ADF test) – must read guide,;citation_publication_date=2019;citation_publisher=https://bit.ly/3vGVsEY;citation_author= Prabhakaran"/>
  <meta name="citation_reference" content="citation_title=Comparison of time series ARIMA model and support vector regression;citation_publication_date=2020;citation_volume=13;citation_author=Yekta S Amirkhalili;citation_author=Amir Aghsami;citation_author=Fariborz Jolai"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","creative_commons","repository_url","output","preview","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["Time Series Forecasting on Energy Consumption"]},{"type":"character","attributes":{},"value":["In this article we provide some exciting results of our exploration of different supervised Machine Learning algorithms (ARIMA, Extra Trees, Gradient Boosting and Support Vector Machines) and an Auto Machine Learning Framework (AutoGluon) in predicting power consumption for the city of Tetouan, Morocco in 2017. The data set is a time series that alsoincludes different markers of the weather conditions during that time, such as temperature, wind speed, and humidity. We build on work from an existing study, with a different approach in terms of data cleaning/transformation and models selected. We use a variety of models in an attempt to find which one best optimizes both accuracy and computational efficiency. \n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Kabir Sandrolini"]},{"type":"character","attributes":{},"value":["https://github.com/ksandrolini"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Katalin Bayer"]},{"type":"character","attributes":{},"value":["https://github.com/KatBayer"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Jiayu Yang"]},{"type":"character","attributes":{},"value":["https://github.com/zeitgeist-hash"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Angela Duarte Pardo"]},{"type":"character","attributes":{},"value":["https://github.com/aduarte56"]}]}]},{"type":"character","attributes":{},"value":["2022-05-10"]},{"type":"character","attributes":{},"value":["Machine Learning"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["https://github.com/allisonkoh/distill-template/"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","fig_caption"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["figures/BERTfig3.png"]},{"type":"character","attributes":{},"value":["bibliography.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bibliography.bib","figures/ACF_plot.png","figures/Auto.png","figures/Composite_forecast.png","figures/Correlations.png","figures/corrmat-2.png","figures/cross_validation.png","figures/ET.png","figures/GB.png","figures/google-scholar.pdf","figures/Mean_forecast.png","figures/Naive_forecast.png","figures/OverallConsumption.png","figures/process_graph.png","figures/Seasonality_plot.png","figures/split.png","figures/StationaryTS.png","figures/svr_test.png","ML_proyect_files/anchor-4.2.2/anchor.min.js","ML_proyect_files/bowser-1.9.3/bowser.min.js","ML_proyect_files/distill-2.2.21/template.v2.js","ML_proyect_files/header-attrs-2.14/header-attrs.js","ML_proyect_files/jquery-3.6.0/jquery-3.6.0.js","ML_proyect_files/jquery-3.6.0/jquery-3.6.0.min.js","ML_proyect_files/jquery-3.6.0/jquery-3.6.0.min.map","ML_proyect_files/popper-2.6.0/popper.min.js","ML_proyect_files/tippy-6.2.7/tippy-bundle.umd.min.js","ML_proyect_files/tippy-6.2.7/tippy-light-border.css","ML_proyect_files/tippy-6.2.7/tippy.css","ML_proyect_files/tippy-6.2.7/tippy.umd.min.js","ML_proyect_files/webcomponents-2.0.0/webcomponents.js","Tex-files/final-report.md","Tex-files/final-report.tex"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="ML_proyect_files/header-attrs-2.14/header-attrs.js"></script>
  <script src="ML_proyect_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="ML_proyect_files/popper-2.6.0/popper.min.js"></script>
  <link href="ML_proyect_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="ML_proyect_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="ML_proyect_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="ML_proyect_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="ML_proyect_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="ML_proyect_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="ML_proyect_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Time Series Forecasting on Energy Consumption","description":"In this article we provide some exciting results of our exploration of different supervised Machine Learning algorithms (ARIMA, Extra Trees, Gradient Boosting and Support Vector Machines) and an Auto Machine Learning Framework (AutoGluon) in predicting power consumption for the city of Tetouan, Morocco in 2017. The data set is a time series that alsoincludes different markers of the weather conditions during that time, such as temperature, wind speed, and humidity. We build on work from an existing study, with a different approach in terms of data cleaning/transformation and models selected. We use a variety of models in an attempt to find which one best optimizes both accuracy and computational efficiency.","authors":[{"author":"Kabir Sandrolini","authorURL":"https://github.com/ksandrolini","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""},{"author":"Katalin Bayer","authorURL":"https://github.com/KatBayer","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""},{"author":"Jiayu Yang","authorURL":"https://github.com/zeitgeist-hash","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""},{"author":"Angela Duarte Pardo","authorURL":"https://github.com/aduarte56","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-05-10T00:00:00.000+02:00","citationText":"Sandrolini, et al., 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Time Series Forecasting on Energy Consumption</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">Machine Learning</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>In this article we provide some exciting results of our exploration of different supervised Machine Learning algorithms (ARIMA, Extra Trees, Gradient Boosting and Support Vector Machines) and an Auto Machine Learning Framework (AutoGluon) in predicting power consumption for the city of Tetouan, Morocco in 2017. The data set is a time series that alsoincludes different markers of the weather conditions during that time, such as temperature, wind speed, and humidity. We build on work from an existing study, with a different approach in terms of data cleaning/transformation and models selected. We use a variety of models in an attempt to find which one best optimizes both accuracy and computational efficiency.</p></p>
</div>

<div class="d-byline">
  Kabir Sandrolini <a href="https://github.com/ksandrolini" class="uri">https://github.com/ksandrolini</a> 
  
,   Katalin Bayer <a href="https://github.com/KatBayer" class="uri">https://github.com/KatBayer</a> 
  
,   Jiayu Yang <a href="https://github.com/zeitgeist-hash" class="uri">https://github.com/zeitgeist-hash</a> 
  
,   Angela Duarte Pardo <a href="https://github.com/aduarte56" class="uri">https://github.com/aduarte56</a> 
  
<br/>2022-05-10
</div>

<div class="d-article">
<h2 id="introduction">Introduction</h2>
<p>Machine Learning has developed into a key tool for modeling energy consumption. Some models can provide accurate forecasts that can then be used to improve the performance of electric systems by reducing the amount of production surpluses and energy shortages. The economic benefits can be significant, as well-constructed ML models of energy consumption can help prevent energy blackouts and reduce wasteful overproduction, cutting costs (for producers, consumers, and States in general) and contributing towards a more sustainable future.</p>
<p>However, <strong>one of the most pressing difficulties with consumption forecasting is the time dependency of the data</strong>. In time series data, each observation depends on the previous one(s). In mathematical terms, time series data is not independent and identically distributed (<span class="math inline">\(i.i.d\)</span>) because the underlying generating process is not stochastic, one of the basic assumptions for regression models. This dependency can generate trends that, if left untreated, can create issues in traditional estimation approaches, including machine learning models because it is very easy for the learning algorithms to reproduce the trend of previous data points instead of finding a function of the target based on the covariates.</p>
<p>In our project “Time Series Forecasting on Energy Consumption,” we evaluated the performance of five different machine learning models in a consumption forecasting task after accounting for the time dependency of the data. The main objective was to compare the accuracy of our models when predicting energy consumption in Tetouan, Morocco during 2017 based on weather conditions as well as temporal variables. To do so, we used a classical time series ARIMA model as a baseline, and then evaluated the performance of various standard machine learning models: Gradient Boosting, ExtraTrees, Support Vector Machines (SVM), and Auto ML framework AutoGluon developed by Amazon.</p>
<p>This task was also done in the paper "Comparison of machine learning algorithms for the power consumption prediction:case study of Tetouan city"<span class="citation" data-cites="salam2018comparison">(<a href="#ref-salam2018comparison" role="doc-biblioref">Salam and El Hibaoui 2018</a>)</span>. However, by design, we chose not use the same models or follow the same approach as the original study. More importantly, the previous paper does not explicitly account for the time-series nature of the data, which is one of the challenges we chose to account for in our exploration.</p>
<p>In this article we will walk you through our main findings when developing the project. It is worth noticing that we developed all of our models in Python, primarily using the numPy, matplotlib, pandas, pmdarima, SciKitLearn, and Autogluon packages and only our local machines to access Google’s cloud servers. For more details onour work, you can visit our github repo<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> and read our final report.</p>
<h2 id="first-things-first-an-overview-of-the-data.">First things first: an overview of the data.</h2>
<p>The data set was originally derived from a study conducted at the Abdelmalek Essaadi University in Morocco in 2018<span class="citation" data-cites="salam2018comparison">(<a href="#ref-salam2018comparison" role="doc-biblioref">Salam and El Hibaoui 2018</a>)</span>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> It is a very good data set to evaluate machine learning models in time-series forecasting tasks because it is labelled data set, has missing values, and has a multivariate time series structure.</p>
<p>The power consumption of Tetouan is divided into three source stations: Quods, Smir and Boussafou. Each data point represents the aggregated power consumption in each respective station or zone observed in 10-minute increments, over a 1-year time period from January 1 2017 to December 30 2017. Moreover, for each power consumption observation, the data set includes weather-related observations, including humidity, wind speed, general diffuse flows, and diffuse flows <span class="citation" data-cites="salam2018comparison">(<a href="#ref-salam2018comparison" role="doc-biblioref">Salam and El Hibaoui 2018</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig1"></span>
<img src="figures/OverallConsumption.png" alt="Power Consumption" width="2000" />
<p class="caption">
Figure 1: Power Consumption
</p>
</div>
</div>
<p>Figure <a href="#fig:fig1">1</a> visualizes energy consumption for the three zones every 10 minutes over the course of a year. We can already identify some significant seasonal fluctuations in power consumption, with a notable increase during the summer in all three zones (particularly in Zone 3 -Boussafou). This makes sense: Tetouan has a Mediterranean climate with mild temperatures in the winter and high temperatures in the summer. The spike in summer consumption is likely caused by an increase of air conditioning, as well as a general increase in the population caused by the summer influx of tourists <span class="citation" data-cites="salam2018comparison">(<a href="#ref-salam2018comparison" role="doc-biblioref">Salam and El Hibaoui 2018</a>)</span>.</p>
<p>We performed many transformations on the data for our analysis, extracting temporal dummy variables from the original data. Since energy consumption varies highly by time of day in addition to the season, we included variables for days, months, hours, and so on. We also averaged the 10-minute readings into a single hourly observation, and the mean of the three zones into a single composite geographic average, as for our purposes we did not need such a granular approach to the data.</p>
<h3 id="stationarity">Stationarity</h3>
<p>Stationarity is a key requirement for many estimation methods. In non-stationary time series the mean, variance and auto-correlation structures change over time, a clear indicator of <span class="math inline">\(i.i.d\)</span> assumptions being violated. We cannot expect unbiased estimators and good machine learning predictions, if our models violate key assumptions <span class="citation" data-cites="Stationarity">(<a href="#ref-Stationarity" role="doc-biblioref">NIST/SEMATECH 2012</a>)</span>.</p>
<p>To check whether our time series is stationary, we calculated the results of the <em>Augmented Dickey Fuller</em> (ADFuller) test on our target variable (<em>MeanConsumption</em>) , which is a statistical test, part of the <em>statsmodels</em> package. The test has a null hypothesis: "the time series is non-stationary", which can be rejected if <span class="math inline">\(p-value&lt;0.05\)</span> <span class="citation" data-cites="ADFTest">(<a href="#ref-ADFTest" role="doc-biblioref">Prabhakaran 2019</a>)</span>.</p>
<p>The results in <em>Table 1</em> confirm that the time series in Tetouan is indeed non-stationary, and that this non-stationarity is due to some peaks in the consumption of the summer months (shown also in the second column of our table).</p>
<div class="{tab:AdFuller}">
<table>
<caption>Results of the Adfuller test on the target variable.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Statistic</th>
<th style="text-align: center;">Target</th>
<th style="text-align: center;">SummerMonths</th>
<th style="text-align: center;"><span class="math inline">\(\Delta\)</span>Target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ADF</td>
<td style="text-align: center;">-2.57</td>
<td style="text-align: center;">-1.39</td>
<td style="text-align: center;">-16.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">p-value</td>
<td style="text-align: center;">0.0985</td>
<td style="text-align: center;">0.59</td>
<td style="text-align: center;"><span class="math inline">\(3.54e^{-29}\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>To make our data stationary, we used differences of observations. The results of the differentiation can also be observed in the third column of @ref{tab:AdFuller}: our new time series became stationary! We are ready now to fit and test our machine learning models.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig10"></span>
<img src="figures/StationaryTS.png" alt="Stationary Time Series" width="1888" />
<p class="caption">
Figure 2: Stationary Time Series
</p>
</div>
</div>
<h2 id="our-approach-to-time-series-forecasting-proposed-method-and-experimental-details">Our Approach to Time Series Forecasting (Proposed Method and Experimental details)</h2>
<p>By design, we chose not use the same models or follow the same approach as the original study. The authors of that study predict energy consumption at both 10 minutes and 1 hour intervals, generating three different models per zone of the city.</p>
<p>Instead, we chose to better account for the time dependency of our data to get a better sense of ML’s performance in time series forecasting problems. Since the data is not IID, we decided to adjust for its temporal nature by using an ARIMA model as a baseline and differencing the target variable to make the data stationary before fitting our models: ExtraTrees, SVM, Gradient Boosting, and using AutoGluon.</p>
<p>In the following section we briefly explain the models we used. Feel free to skip it if you feel you are already familiar with them.</p>
<h3 id="baseline---arima-model">Baseline - ARIMA model</h3>
<p>Accounting for time series data is typically done by using ARIMA models. We chose this modeldue to the additional seasonal daily lags (24-hour increments) that are captured by the Moving Average (MA) lags used by them. The underlying estimation process is maximum likelihood estimation and indeed, this drastically increases the computational runtime.</p>
<p>Ultimately, amongst the class of ARIMA models, the optimal time series model for our data is a Seasonal Auto Regressive Integrated Moving Average eXogenous (SARIMAX) model. This subclass of ARIMA includes seasonality lags as well as differencing the time series first observations, as opposed to ARIMA which only considers AR and MA lags.</p>
<p>In determining the baseline model, we used the pmdarima package, and primarily its auto_arima function. This function automates all of the necessary data transformations, as carried out manually for the other models above, and then proceeds to algorithmically determine the optimal ARIMA model.</p>
<h4 id="arima-models-experimental-details">Arima Model’s Experimental Details</h4>
<p>A key difference in the implementation between the ARIMA baseline model and the other ML models we considered was the test-training split. In auto_arima, which uses scikitLearn’s TimeSeriesSplit, which splits the data into several sets of training and testing data whilst retaining the time series element. As the auto_arima function runs, the training sets updates in a rolling manner until the last test set is reached. This is then used as the validation set and the model forecast on this validation set, is used as our comparison measure.</p>
<p>The pm.utils.tsdisplay() function returns the following three visualisations. Figure <a href="#fig:fig2">3</a> below shows the desirable stationarity of our power consumption data after taking the first difference.The ACF plot indicates the strong seasonal component of the data series which informed the choice of including seasonal lags in our ARIMA model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig2"></span>
<img src="figures/ACF_plot.png" alt="Top: Plotting the Differenced Data. Bottom Left: ACF plot. Bottom Right: Histogram" width="100%" />
<p class="caption">
Figure 3: Top: Plotting the Differenced Data. Bottom Left: ACF plot. Bottom Right: Histogram
</p>
</div>
</div>
<p>In order to determine this optimal model, the auto_arima function performs a step-wise procedure across various model specifications and determines the best model from four different specifications to start with.</p>
<p>Out of these four, the best model is chosen according to the lowest <em>Akaike Information Criterion</em>. The other models are then updated in a stepwise adjustment of the parameters with respect to current best model, AICs are recomputed and compared again and the new best model gets updated. This iterative process is repeated until no model with a lower AIC can be found and a threshold is reached. This is another feature than can be tuned by the user, among the many parameters and choices the user makes.</p>
<h3 id="machine-learning-models-architecture">Machine Learning Models Architecture</h3>
<p>Our data set includes labels for Mean Power Consumption. We therefore used supervised learning models for our prediction task:</p>
<ul>
<li><p><em>Extra Trees</em> or <em>Extremely Randomized Trees</em> are an improvement of Decision Trees. Like Random Forests, Extra Trees combine the predictions of many trees into a single prediction, by choosing the best split between the subsets of features. Unlike Random Forests,Extra Trees randomize both attributes and cut-points in the node splitting process (thus reducing variance), and use the whole data set for the training process (reducing bias)<span class="citation" data-cites="geurts2006extremely">(<a href="#ref-geurts2006extremely" role="doc-biblioref">Geurts, Ernst, and Wehenkel 2006</a>)</span>. They end up having similar performance to Random Forests, but through a simpler and faster algorithm.<span class="citation" data-cites="ExtraVsRandom">(<a href="#ref-ExtraVsRandom" role="doc-biblioref">Aznar 2020</a>)</span></p></li>
<li><p><em>Support Vector Machines</em> are versatile Machine Learning models that work by finding the largest possible margin separates "classes" of instances on a given space. SVM Regression (or SVR) models use these margins to fit as many possible instances, while minimizing the prediction error <span class="citation" data-cites="geron2019hands">(<a href="#ref-geron2019hands" role="doc-biblioref">Géron 2019</a>)</span>.</p></li>
<li><p><em>Gradient Boosting</em> is an algorithm that boosts weak learners into strong learners. The Boosting training process is a tandem approach where the weak learners are trained sequentially, with each weak learner learning from the previous one and eventually combining the predictions of all the learners to produce the final prediction. It has relatively fast training times, as well as high performance.</p></li>
</ul>
<h4 id="ml-models-experimental-details">ML Model’s Experimental Details</h4>
<p>As usually happens on ML projects, we split the training set, validation set and test set in a ratio of 6:2:2. Since the data is based on time-series, this separation had no random component (if we did the usual train/test splitting, we would risk having future observations predicting past observations).</p>
<p>Our validation and testing sets correspond then to the 40% of the newest observations so that the training is done in the earliest part of the time-series and the predictions on the subsequent observations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig3"></span>
<img src="figures/split.png" alt="Set splitting into training, validation and testing sets." width="100%" />
<p class="caption">
Figure 4: Set splitting into training, validation and testing sets.
</p>
</div>
</div>
<p>We then calculated the difference between the target variable at time <span class="math inline">\(t\)</span> and at time <span class="math inline">\(t-1\)</span>. This differentiation allowed us to have a stationary data set, as can be seen in Table1.</p>
<p>For better accuracy of our predictions, we added 1-hour, 2-hour and 24-hour lagged differences to the weather and seasonality covariates. These time lags are those that minimize the ARIMA model’s AIC and therefore are considered the appropriate lags to include. Whilst the function also determines the relevant MA lags, it is becomes very complicated compute these manually in order to include them so we determined to exclusively include AR lags in the remainder of the ML models we test.</p>
<p>For SVM, ExtraTrees and Gradient Boosting models, we initially trained them with default settings and applied them on the validation sets. Then we compared their performances based on their evaluation metrics. After that we did the fine-tuning process to find best model parameters with GridSearchSV function for those models.</p>
<p>Table 3 shows the optimal parameters that we used for our testing set prediction.</p>
<div id="tab:some_table">
<table>
<caption>Model configurations after running GridSearch for parameter tuning.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: center;">Fine-tuning</th>
<th style="text-align: center;">Training time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ExtraTrees</td>
<td style="text-align: center;">max_depth=11</td>
<td style="text-align: center;">2.3s</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">n_estimators=20</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;">min_split=60</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">SVM</td>
<td style="text-align: center;">C=1000</td>
<td style="text-align: center;">2.78s</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;">gamma= 0.0001</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Gradient Boosting</td>
<td style="text-align: center;">max_depth=3</td>
<td style="text-align: center;">2s</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;">n_estimators=60</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">min_split=80</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<h3 id="automl-model-autogluon">AutoML model-Autogluon</h3>
<p>Autogluon is an open-source framework that enables easy-to-use and easy-to-extend machine learning approaches developed by Amazon <span class="citation" data-cites="ge2020analysis">(<a href="#ref-ge2020analysis" role="doc-biblioref">Ge 2020</a>)</span>. It only needs a few lines of simple and elegant code to prototype multiple classical machine learning models, leveraging automatic hyperparameter tuning and stacking them in multiple layers for comparison. AutoGluon enables users to utilize state-of-the-art techniques without expert knowledge and conduct significant gains in accuracy and time-efficiency <span class="citation" data-cites="AutoGluon-Tabular2020">(<a href="#ref-AutoGluon-Tabular2020" role="doc-biblioref">Erickson et al. 2020</a>)</span>.</p>
<h2 id="evaluation-methods">Evaluation methods</h2>
<p>Evaluating the accuracy of different machine learning models is an essential part of an ML project, as it provides common metrics for comparing and optimizing model selection. We used three main metrics: R Squared (<span class="math inline">\(R^{2}\)</span>), Mean Squared Error (MSE) / Root Mean Squared Error (RMSE)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, and Mean Absolute Error (MAE). All these metrics are summarized in Table X. They indicate the difference between our predicted values (<span class="math inline">\(\hat{y}^{(i)}\)</span>) and the actual values, and can be calculated by using different functions from scikit-learn library.</p>
<div id="tab:some_table">
<table>
<caption>Evaluation metrics,</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Formula</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(R^{2}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(1-\frac{\sum_{i=1}(\hat{y}^{(i)}-y^{(i)})^{2}}{\sum_{i=1}^{m}(y^{(i)}-\bar{y})^{2}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(MSE\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{1}{m}\sum_{i=1}^{m}(\hat{y}^{(i)}-y^{(i)})^{2}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(MAE\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{1}{m}\sum_{i=1}^{m}\lvert{\hat{y}^{(i)}-y^{(i)}}\rvert.\)</span></td>
</tr>
</tbody>
</table>
</div>
<p><span class="math inline">\(R^{2}\)</span> or the <em>coefficient of determination</em> provides a measure of how well we can explain the variance in the dependent variable from the variance of other predictors.In the formula, <span class="math inline">\(\bar{y}\)</span> corresponds to the mean of observed values. <span class="math inline">\(R^{2}\)</span> is an intuitive measure of error for regression problems because a measure of 1 means the model captures all variance of the dependent variable, while lower values indicate relative worse model fit.</p>
<p>However, many advise against over-relying on this measure to test the performance of Machine Learning algorithms in time-series forecasting. The <span class="math inline">\(R^{2}\)</span> value for a time series model could seemingly indicate high accuracy, but can be caused by the auto-correlation due to time-dependency, as successive observations are intrinsically related to each other <span class="citation" data-cites="pierce">(<a href="#ref-pierce" role="doc-biblioref">Pierce 1979</a>)</span>. For this reason, we did not report <span class="math inline">\(R^2\)</span> values for our ARIMA models; because it is a standard practice, we provided it for the other models, although it wasn’t our main comparative measure, MSE/RMSE was. It is worth noting that in time-series analytics a smaller RMSE indicates better results<span class="citation" data-cites="amirkhalili2020comparison">(<a href="#ref-amirkhalili2020comparison" role="doc-biblioref">Amirkhalili, Aghsami, and Jolai 2020</a>)</span>.</p>
<h2 id="some-results">Some Results</h2>
<p>Table X shows the accuracy and error measures for the baseline and other models we trained in the experimental phase of the project.</p>
<div id="tab:tab1">
<table>
<caption>Model configurations after running GridSearch for parameter tuning.</caption>
<thead>
<tr class="header">
<th>Model</th>
<th><span class="math inline">\(R^{2}\)</span></th>
<th>RMSE</th>
<th>MSE</th>
<th>MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Naive ARMA</td>
<td>/</td>
<td>1152.50</td>
<td>1328259.10</td>
<td>760.19</td>
</tr>
<tr class="even">
<td>Mean SARIMAX</td>
<td>/</td>
<td>966.15</td>
<td>933447.24</td>
<td>669.56</td>
</tr>
<tr class="odd">
<td>Composite SARIMAX</td>
<td>/</td>
<td>975.38</td>
<td>951366.01</td>
<td>681.46</td>
</tr>
<tr class="even">
<td>ExtraTrees</td>
<td>0.97</td>
<td>340.57</td>
<td>115990.42</td>
<td>241.32</td>
</tr>
<tr class="odd">
<td>SVM</td>
<td>0.09</td>
<td>1749.24</td>
<td>3059843.46</td>
<td>1246.14</td>
</tr>
<tr class="even">
<td>GradBoosting</td>
<td>0.96</td>
<td>348.45</td>
<td>121420.78</td>
<td>245.48</td>
</tr>
</tbody>
</table>
</div>
<h3 id="what-do-this-results-mean-comments-on-the-quantitative-results.">What do this results mean? Comments on the quantitative results.</h3>
<ul>
<li><strong>ARIMA</strong> As soon as the auto_arima parameters have been defined and the code is running, there is little the user can still adjust. Rather than trying to manually recompute the auto_arima processs, we decided to let this code run three times, with different consumption aggregation methods.</li>
<li><ol type="1">
<li>The “Naïve” forecast, which predicts the mean consumption of Tetouan City purely based on the power consumption 24-hours ago, a simple AR(24) model. We chose this as our simple forecast since the data exploration highlighted the importance of the daily lag.</li>
</ol></li>
<li><ol start="2" type="1">
<li>the “Mean” forecast, which lets auto_arima determine the number of optimal lags across various classes of ARMA models.</li>
</ol></li>
<li><ol start="3" type="1">
<li>the last forecast has been denoted the “Composite” forecast, first each Zone’s individual power consumption is predicted using auto_arima, and then the total Mean Consumption is computed as the mean across the three zone’s forecast. The visualisation of only the Mean forecast (only for the forecasted time period) is plotted below in <a href="#fig:fig4">5</a> below.</li>
</ol></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig4"></span>
<img src="figures/Mean_forecast.png" alt="Mean Consumption forecast only for the forecast horizon." width="100%" />
<p class="caption">
Figure 5: Mean Consumption forecast only for the forecast horizon.
</p>
</div>
</div>
<ul>
<li><strong>SVR</strong> Even with the optimal configurations resulting from the grid search algorithm, our SVR model underfits the power consumption stationary time series. The error rates that we obtained when testing the model are high (an error of almost <span class="math inline">\(1750\)</span>, the RMSE, is considerable given that the differentiated means range between -5269 and 8193 KWh))- See table X. Figure <a href="#fig:fig5">6</a> shows that the prediction values seem to pick up the oscillation trend of the time series, but not its variation along the ‘y’ axis.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig5"></span>
<img src="figures/svr_test.png" alt="Predicted vs actual values for optimal SVR ." width="100%" />
<p class="caption">
Figure 6: Predicted vs actual values for optimal SVR .
</p>
</div>
</div>
<ul>
<li><strong>ExtraTrees &amp; GradientBoosting</strong> The RMSE of both ExtraTrees &amp; Gradient Boosting is around 340 after fine-tuning. They performed slightly worse on the testing set than on the validation set as expected. It proves that both of them are very stable and suitable for dealing with time series forecasting problems.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig6-1"></span>
<img src="figures/ET.png" alt="Predicted vs actual values for optimal ExtraTrees and Gradient Boosting." width="100%" />
<p class="caption">
Figure 7: Predicted vs actual values for optimal ExtraTrees and Gradient Boosting.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:fig6-2"></span>
<img src="figures/GB.png" alt="Predicted vs actual values for optimal ExtraTrees and Gradient Boosting." width="100%" />
<p class="caption">
Figure 8: Predicted vs actual values for optimal ExtraTrees and Gradient Boosting.
</p>
</div>
</div>
<ul>
<li><strong>AutoGluon</strong> The Autogluon leader-board below shows per-model performance based on details such as MSE, training time etc. The leader-board shows 12 ML models in total and ranks these models according to how well they perform.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig7"></span>
<img src="figures/Auto.png" alt="Leaderboard of AutoGluon." width="100%" />
<p class="caption">
Figure 9: Leaderboard of AutoGluon.
</p>
</div>
</div>
<h2 id="analysis">Analysis</h2>
<p>Generally speaking, all three results from the regular time series models capture the variance in the dependent variable rather well - in spite of adding no further explanatory variables and purely relying on the lags, seasonality, and moving averages. The regression analysis output in the Appendix show that all of the lag terms determined by auto_arima are statistically significant with p-values of 0. The intuition is sound too, the power consumption of today primarily depends on the power consumption an hour ago, two hours ago, and yesterday. The difference this 24-hour, seasonality lag makes is indicated by <a href="#fig:fig8">10</a> down below. The fact that the Naive forecast performed worst across the three models was hardly surprising, as we include more, relevant lags, the models forecasting ability improves. The expectation was that the composite forecast would outperform the mean as the model would be able to adapt to each Zone individually first. However, despite this not being the case, all performance measures we computed are very close to each other in magnitude.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:fig8"></span>
<img src="figures/Seasonality_plot.png" alt="Search model without (m =1) vs. with (m=24) seasonality." width="100%" />
<p class="caption">
Figure 10: Search model without (m =1) vs. with (m=24) seasonality.
</p>
</div>
</div>
<p>As for the SVR model, despite the optimization process, its performance was the worst of all the studied models: the RMSE was the highest of all models, but the predictions didn’t reach the full amplitude of the labels in our dataset. Despite our expectations, this is not so surprising. A plausible explanation might be that SVM tend to do better with scaled data<span class="citation" data-cites="amirkhalili2020comparison">(<a href="#ref-amirkhalili2020comparison" role="doc-biblioref">Amirkhalili, Aghsami, and Jolai 2020</a>)</span> (which stabilizes both the mean and variance). The process we performed to make the time-series stationary, stabilized only the mean but not the variance (something we decided on not to lose the variations that we wanted to be able to predict).This might explain why our SVR model was "blind" to the high peaks of the hourly differences in power consumption.</p>
<p>However, ExtraTrees and Gradient Boosting models performed quite well on validation sets and testing sets. In terms of the characteristics of these algorithms, ExtraTrees and GradientBoosting belong to ensemble learning that can often achieve significantly better generalisation performance than a single learner by combining multiple learners. From the results of testing sets (both of their RMSE are around 340), they are very robust even in the face of a lot of outliers and time series data.</p>
<p>From the leaderboard (Figure 4) of auto-ML framework AutoGluon, we found that half of the models performed as good as fine-tuned ExtraTrees and GradientBoosting models on the testing set, however the other models performed very generally. Decision trees and boosting techniques have better performance but KNeighbors techniques are not very good.</p>
<h2 id="conclusions">Conclusions</h2>
<p>Our main achievement is that we successfully implemented the time-series nature of our data not only into our baseline model but also included some lag elements in our standard machine learning algorithms. Arguably this is the main result of the paper as can be seen from the ARIMA models, the recurring time aspect by itself, which is reflected in the forecast plots of the baseline model. The next step was to consider whether an additional selection of potential covariates would further improve forecasts. That said, the best model seems to be the Extra trees with an even more improved RMSE of 340.57.</p>
<p>We expected more of the SVR’s models performance. However, it was not surprising that they performed very poorly. Since SVR finds the narrowest tube around high-dimensional surfaces, the high variation of our data causes more deviations to be there included and thus makes the error higher. A new study could try using the SVR’s as part of an ensemble of learners. Because of the advantages of ensemble learning (better generalisation and robustness), we observe that they performed very well and robustly even with time series data.</p>
<p>The most important meaning of AutoGluon is that we can utilize state-of-the-art techniques with a few lines of code without expert knowledge, and it has become easy to make improvements/tweaks to bespoke models. In addition, AutoGluon could also be used in text prediction, object detection and image prediction fields, which has great potential to be explored.</p>
<p>Although we believe our exploration was a successful attempt at understanding the advantages and shortcoming of different machine learning algorithms in a time-series prediction task, our study still has some limitations given by the fact that we didn’t account for the seasonality, calendar variation patterns and moving means in the ML models, while the ARIMA model did. In a future study, we could further explore the SARIMAX potential for these issues, as well as the introduction of other variables that can account for them in the covariate matrix for all the machine learning models.</p>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-amirkhalili2020comparison" class="csl-entry" role="doc-biblioentry">
Amirkhalili, Yekta S, Amir Aghsami, and Fariborz Jolai. 2020. <span>“Comparison of Time Series ARIMA Model and Support Vector Regression.”</span> <em>Int. J. Hybrid Inf. Technol</em> 13 (1): 7–18.
</div>
<div id="ref-ExtraVsRandom" class="csl-entry" role="doc-biblioentry">
Aznar, Pablo. 2020. <span>“What Is the Difference Between Extra Trees and Random Forest?”</span> <a href="shorturl.at/lrCJM">shorturl.at/lrCJM</a>.
</div>
<div id="ref-DataSet" class="csl-entry" role="doc-biblioentry">
Dua, D., and C. Graff. 2009. <span>“UCI Machine Learning Repository.”</span> Irvine, CA: University of California, School of Information; Computer Science. <a href="http://archive.ics.uci.edu/ml">http://archive.ics.uci.edu/ml</a>.
</div>
<div id="ref-AutoGluon-Tabular2020" class="csl-entry" role="doc-biblioentry">
Erickson, Nick, Jonas Mueller, Alexander Shirkov, Hang Zhang, Pedro Larroy, Mu Li, and Alexander Smola. 2020. <span>“AutoGluon-Tabular: Robust and Accurate AutoML for Structured Data.”</span>
</div>
<div id="ref-ge2020analysis" class="csl-entry" role="doc-biblioentry">
Ge, Peixuan. 2020. <span>“Analysis on Approaches and Structures of Automated Machine Learning Frameworks.”</span> In <em>2020 International Conference on Communications, Information System and Computer Engineering (CISCE)</em>, 474–77. IEEE.
</div>
<div id="ref-geron2019hands" class="csl-entry" role="doc-biblioentry">
Géron, Aurélien. 2019. <em>Hands-on Machine Learning with Scikit-Learn, Keras, and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems</em>. " O’Reilly Media, Inc.".
</div>
<div id="ref-geurts2006extremely" class="csl-entry" role="doc-biblioentry">
Geurts, Pierre, Damien Ernst, and Louis Wehenkel. 2006. <span>“Extremely Randomized Trees.”</span> <em>Machine Learning</em> 63 (1): 3–42.
</div>
<div id="ref-Stationarity" class="csl-entry" role="doc-biblioentry">
NIST/SEMATECH. 2012. <span>“E-Handbook of Statistical Methods,”</span> <a href="http://www.itl.nist.gov/div898/handbook/">http://www.itl.nist.gov/div898/handbook/</a>.
</div>
<div id="ref-pierce" class="csl-entry" role="doc-biblioentry">
Pierce, David A. 1979. <span>“R2 Measures for Time Series.”</span> <em>Journal of the American Statistical Association</em> 74 (368): 901–10. <a href="http://www.jstor.org/stable/2286421">http://www.jstor.org/stable/2286421</a>.
</div>
<div id="ref-ADFTest" class="csl-entry" role="doc-biblioentry">
Prabhakaran. 2019. <span>“Augmented Dickey Fuller Test (ADF Test) – Must Read Guide,”</span> <a href="https://bit.ly/3vGVsEY">https://bit.ly/3vGVsEY</a>.
</div>
<div id="ref-salam2018comparison" class="csl-entry" role="doc-biblioentry">
Salam, Abdulwahed, and Abdelaaziz El Hibaoui. 2018. <span>“Comparison of Machine Learning Algorithms for the Power Consumption Prediction:-Case Study of Tetouan City–.”</span> In <em>2018 6th International Renewable and Sustainable Energy Conference (IRSEC)</em>, 1–5. IEEE.
</div>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Here is the link to our GitHub repository <a href="https://github.com/zeitgeist-hash/GRAD-C24-Machine-Learning.git" class="uri">https://github.com/zeitgeist-hash/GRAD-C24-Machine-Learning.git</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>It can also be found at the University of California, School of Information and Computer Science’s online Machine Learning repository<span class="citation" data-cites="DataSet">(<a href="#ref-DataSet" role="doc-biblioref">Dua and Graff 2009</a>)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>RMSE is the square root of the MSE.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/allisonkoh/distill-template/issues/new">create an issue</a> on the source repository.</p>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/allisonkoh/distill-template/">https://github.com/allisonkoh/distill-template/</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
